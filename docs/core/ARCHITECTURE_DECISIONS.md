# æ¶æ„å†³ç­–è®°å½• (Architecture Decision Records)

> **æ–‡æ¡£ç±»å‹:** æŠ€æœ¯è®¾è®¡ / å†³ç­–è®°å½•
> **ç›®æ ‡:** è®°å½• Job Intelligence é¡¹ç›®çš„é‡è¦æŠ€æœ¯å†³ç­–ã€æƒè¡¡åˆ†æå’Œé€‰å‹ç†ç”±
> **æœ€åæ›´æ–°:** 2025-12-20

---

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£é‡‡ç”¨ **ADR (Architecture Decision Record)** æ ¼å¼ï¼Œè®°å½•é¡¹ç›®ä¸­çš„é‡è¦æŠ€æœ¯å†³ç­–ã€‚

**æ¯ä¸ªå†³ç­–åŒ…å«:**
- **èƒŒæ™¯ (Context):** ä¸ºä»€ä¹ˆéœ€è¦åšè¿™ä¸ªå†³ç­–ï¼Ÿ
- **å†³ç­– (Decision):** æˆ‘ä»¬é€‰æ‹©äº†ä»€ä¹ˆæ–¹æ¡ˆï¼Ÿ
- **æƒè¡¡ (Trade-offs):** æœ‰å“ªäº›æ›¿ä»£æ–¹æ¡ˆï¼Ÿä¸ºä»€ä¹ˆæ²¡é€‰ï¼Ÿ
- **åæœ (Consequences):** è¿™ä¸ªå†³ç­–å¸¦æ¥ä»€ä¹ˆå½±å“ï¼Ÿ

**ä½¿ç”¨æ–¹å¼:**
- âœ… é¢è¯•æ—¶å‚è€ƒï¼Œè§£é‡ŠæŠ€æœ¯é€‰å‹ç†ç”±
- âœ… å­¦ä¹ ä¸åŒæ–¹æ¡ˆçš„ä¼˜ç¼ºç‚¹
- âœ… æœªæ¥é‡æ„æ—¶å›é¡¾å½“æ—¶çš„å†³ç­–èƒŒæ™¯

---

## ç›®å½•

1. [ADR-001: é€‰æ‹© Python FastAPI ä½œä¸ºçˆ¬è™«æœåŠ¡æ¡†æ¶](#adr-001-é€‰æ‹©-python-fastapi-ä½œä¸ºçˆ¬è™«æœåŠ¡æ¡†æ¶)
2. [ADR-002: é€‰æ‹©é€‚é…å™¨æ¨¡å¼å®ç°å¤šæ•°æ®æºæ”¯æŒ](#adr-002-é€‰æ‹©é€‚é…å™¨æ¨¡å¼å®ç°å¤šæ•°æ®æºæ”¯æŒ)
3. [ADR-003: é€‰æ‹© TDD å¼€å‘å·¥å…·å‡½æ•°](#adr-003-é€‰æ‹©-tdd-å¼€å‘å·¥å…·å‡½æ•°)
4. [ADR-004: ç¼“å­˜å±‚æ¶æ„è®¾è®¡](#adr-004-ç¼“å­˜å±‚æ¶æ„è®¾è®¡)
5. [ADR-005: é€‰æ‹© PostgreSQL ä½œä¸ºä¸»æ•°æ®åº“](#adr-005-é€‰æ‹©-postgresql-ä½œä¸ºä¸»æ•°æ®åº“)
6. [ADR-006: é€‰æ‹© .NET 8 ä½œä¸ºåç«¯æ¡†æ¶](#adr-006-é€‰æ‹©-net-8-ä½œä¸ºåç«¯æ¡†æ¶)
7. [ADR-007: é€‰æ‹© Hangfire ä½œä¸ºåå°ä»»åŠ¡æ¡†æ¶](#adr-007-é€‰æ‹©-hangfire-ä½œä¸ºåå°ä»»åŠ¡æ¡†æ¶)

---

## ADR-001: é€‰æ‹© Python FastAPI ä½œä¸ºçˆ¬è™«æœåŠ¡æ¡†æ¶

**çŠ¶æ€:** âœ… å·²é‡‡çº³
**æ—¥æœŸ:** 2025-12-18
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P0ï¼ˆæ ¸å¿ƒæ¶æ„ï¼‰

### èƒŒæ™¯ (Context)

æˆ‘ä»¬éœ€è¦ä¸ºçˆ¬è™«æœåŠ¡é€‰æ‹©ä¸€ä¸ª Python Web æ¡†æ¶ï¼Œä¸»è¦éœ€æ±‚åŒ…æ‹¬:
1. å¿«é€Ÿå®ç° RESTful APIï¼ˆä¸ .NET åç«¯é€šä¿¡ï¼‰
2. è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼ˆSwagger/OpenAPIï¼‰
3. æ”¯æŒæ•°æ®éªŒè¯ï¼ˆè¯·æ±‚å‚æ•°æ ¡éªŒï¼‰
4. æœªæ¥å¯èƒ½éœ€è¦å¤„ç†å¹¶å‘è¯·æ±‚

### å†³ç­– (Decision)

**é€‰æ‹© FastAPI**

**æ ¸å¿ƒç†ç”±:**
1. **è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ:** å†…ç½® Swagger UI å’Œ ReDocï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™ API æ–‡æ¡£
2. **æ•°æ®éªŒè¯:** åŸºäº Pydanticï¼Œè‡ªåŠ¨éªŒè¯è¯·æ±‚å‚æ•°ï¼Œå‡å°‘é”™è¯¯å¤„ç†ä»£ç 
3. **ç°ä»£åŒ–è®¾è®¡:** æ”¯æŒç±»å‹æç¤ºï¼ˆtype hintsï¼‰ï¼Œä»£ç å¯è¯»æ€§å¥½
4. **æ€§èƒ½ä¼˜åŠ¿:** åŸºäºå¼‚æ­¥ ASGIï¼ˆè™½ç„¶å½“å‰ä¸éœ€è¦ï¼Œä½†ä¸ºæœªæ¥é¢„ç•™ç©ºé—´ï¼‰
5. **å­¦ä¹ ä»·å€¼:** FastAPI æ˜¯å½“å‰ä¸»æµæ¡†æ¶ï¼Œé¢è¯•æ—¶å¯ä»¥å±•ç¤º

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: Flask
```python
# Flask ç¤ºä¾‹
@app.route('/scrape/seek', methods=['POST'])
def scrape_seek():
    data = request.get_json()
    keywords = data.get('keywords')  # æ‰‹åŠ¨æå–å‚æ•°

    if not keywords:  # æ‰‹åŠ¨éªŒè¯
        return jsonify({"error": "keywords is required"}), 400

    adapter = SeekAdapter()
    jobs = adapter.scrape(keywords)
    return jsonify({"jobs": jobs})
```

**ä¼˜ç‚¹:**
- ç®€å•ã€è½»é‡ã€å­¦ä¹ æ›²çº¿å¹³ç¼“
- ç”Ÿæ€æˆç†Ÿã€èµ„æºä¸°å¯Œ

**ç¼ºç‚¹:**
- âŒ æ²¡æœ‰è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆï¼ˆéœ€è¦ Flask-RESTPlus/Flasggerï¼‰
- âŒ æ²¡æœ‰å†…ç½®æ•°æ®éªŒè¯ï¼ˆéœ€è¦æ‰‹åŠ¨éªŒè¯æˆ– marshmallowï¼‰
- âŒ åŒæ­¥æ¡†æ¶ï¼ˆå¹¶å‘æ€§èƒ½è¾ƒå·®ï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- éœ€è¦é¢å¤–é…ç½®æ‰èƒ½å®ç° FastAPI çš„å†…ç½®åŠŸèƒ½
- å¼€å‘æ•ˆç‡è¾ƒä½ï¼ˆæ›´å¤šæ‰‹åŠ¨ä»£ç ï¼‰

---

#### æ–¹æ¡ˆ B: Django REST Framework (DRF)
```python
# DRF ç¤ºä¾‹
class ScrapeSeekView(APIView):
    def post(self, request):
        serializer = ScrapeRequestSerializer(data=request.data)
        if serializer.is_valid():
            keywords = serializer.validated_data['keywords']
            adapter = SeekAdapter()
            jobs = adapter.scrape(keywords)
            return Response({"jobs": jobs})
        return Response(serializer.errors, status=400)
```

**ä¼˜ç‚¹:**
- åŠŸèƒ½å®Œæ•´ï¼ˆåŒ…å« ORMã€Adminã€Authï¼‰
- é€‚åˆå¤§å‹é¡¹ç›®

**ç¼ºç‚¹:**
- âŒ è¿‡äºé‡é‡çº§ï¼ˆæˆ‘ä»¬åªéœ€è¦ APIï¼Œä¸éœ€è¦ ORM/Adminï¼‰
- âŒ å­¦ä¹ æ›²çº¿é™¡å³­
- âŒ é…ç½®å¤æ‚ï¼ˆsettings.py, urls.py, serializers.pyï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- æˆ‘ä»¬å·²ç»æœ‰ .NET åç«¯å¤„ç†æ•°æ®åº“å’Œä¸šåŠ¡é€»è¾‘
- çˆ¬è™«æœåŠ¡åªéœ€è¦ API å±‚ï¼ŒDRF çš„å¾ˆå¤šåŠŸèƒ½ç”¨ä¸ä¸Š
- å¼€å‘æˆæœ¬é«˜ï¼ˆé…ç½®å’Œå­¦ä¹ æ—¶é—´ï¼‰

---

#### æ–¹æ¡ˆ C: FastAPIï¼ˆæœ€ç»ˆé€‰æ‹©ï¼‰
```python
# FastAPI ç¤ºä¾‹
@app.post("/scrape/seek")
def scrape_seek(request: ScrapeRequest):  # è‡ªåŠ¨éªŒè¯å’Œæ–‡æ¡£
    adapter = SeekAdapter()
    jobs = adapter.scrape(request)
    return {"jobs": jobs}

# Pydantic æ¨¡å‹ï¼ˆè‡ªåŠ¨éªŒè¯ï¼‰
class ScrapeRequest(BaseModel):
    keywords: str  # å¿…éœ€
    location: Optional[str] = None  # å¯é€‰
    max_results: int = 50  # é»˜è®¤å€¼

    @validator('keywords')
    def validate_keywords(cls, v):
        if not v.strip():
            raise ValueError('keywords ä¸èƒ½ä¸ºç©º')
        return v
```

**ä¼˜ç‚¹:**
- âœ… ä»£ç ç®€æ´ï¼ˆæœ€å°‘çš„æ ·æ¿ä»£ç ï¼‰
- âœ… è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆï¼ˆè®¿é—® /docs å³å¯æŸ¥çœ‹ï¼‰
- âœ… è‡ªåŠ¨æ•°æ®éªŒè¯ï¼ˆPydanticï¼‰
- âœ… é«˜æ€§èƒ½ï¼ˆå¼‚æ­¥æ”¯æŒï¼‰
- âœ… ç°ä»£åŒ–ï¼ˆç±»å‹æç¤ºã€async/awaitï¼‰

**ç¼ºç‚¹:**
- ç”Ÿæ€ç›¸å¯¹å¹´è½»ï¼ˆä½†å·²ç»è¶³å¤Ÿæˆç†Ÿï¼‰
- éœ€è¦å­¦ä¹  Pydantic å’Œå¼‚æ­¥ç¼–ç¨‹ï¼ˆä½†å­¦ä¹ æˆæœ¬ä¸é«˜ï¼‰

**ä¸ºä»€ä¹ˆé€‰æ‹©?**
- æ»¡è¶³æ‰€æœ‰éœ€æ±‚ï¼Œä¸”å¼€å‘æ•ˆç‡æœ€é«˜
- å­¦ä¹ ä»·å€¼é«˜ï¼ˆå½“å‰ä¸»æµæŠ€æœ¯ï¼‰
- ä¸ºæœªæ¥æ‰©å±•ç•™å‡ºç©ºé—´ï¼ˆå¼‚æ­¥ã€WebSocketï¼‰

---

### å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§ | Flask | Django REST | FastAPI |
|------|-------|-------------|---------|
| å¼€å‘æ•ˆç‡ | â­â­â­ | â­â­ | â­â­â­â­â­ |
| è‡ªåŠ¨æ–‡æ¡£ | âŒ | âœ… | âœ… |
| æ•°æ®éªŒè¯ | âŒ | âœ… | âœ… |
| æ€§èƒ½ | â­â­ | â­â­ | â­â­â­â­â­ |
| å­¦ä¹ æ›²çº¿ | â­â­â­â­â­ | â­â­ | â­â­â­â­ |
| é€‚åˆåœºæ™¯ | ç®€å• API | å¤§å‹é¡¹ç›® | ç°ä»£ API |

### åæœ (Consequences)

**æ­£é¢å½±å“:**
- âœ… å¼€å‘é€Ÿåº¦å¿«ï¼ˆ3 å°æ—¶å®Œæˆæ ¸å¿ƒéª¨æ¶ï¼‰
- âœ… API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼Œä¾¿äºæµ‹è¯•å’Œå¯¹æ¥ .NET åç«¯
- âœ… ä»£ç è´¨é‡é«˜ï¼ˆç±»å‹æç¤ºå‡å°‘é”™è¯¯ï¼‰
- âœ… é¢è¯•æ—¶å¯ä»¥å±•ç¤ºç°ä»£ Python æŠ€æœ¯æ ˆ

**è´Ÿé¢å½±å“:**
- âš ï¸ éœ€è¦å­¦ä¹  Pydanticï¼ˆä½†å­¦ä¹ æˆæœ¬ä½ï¼‰
- âš ï¸ å¼‚æ­¥ç¼–ç¨‹å¯èƒ½å¢åŠ å¤æ‚åº¦ï¼ˆä½†å½“å‰ä¸éœ€è¦å¼‚æ­¥ï¼‰

**å®é™…æ•ˆæœ:**
- æˆåŠŸå®ç° 3 ä¸ª API ç«¯ç‚¹ï¼ˆ/health, /scrape/indeed, /scrape/seekï¼‰
- Swagger UI å¯ç”¨ï¼Œä¾¿äºæµ‹è¯•
- å¼€å‘ä½“éªŒè‰¯å¥½

---

## ADR-002: é€‰æ‹©é€‚é…å™¨æ¨¡å¼å®ç°å¤šæ•°æ®æºæ”¯æŒ

**çŠ¶æ€:** âœ… å·²é‡‡çº³
**æ—¥æœŸ:** 2025-12-18
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P0ï¼ˆæ ¸å¿ƒæ¶æ„ï¼‰

### èƒŒæ™¯ (Context)

æˆ‘ä»¬éœ€è¦æ”¯æŒå¤šä¸ªèŒä½æ•°æ®æºï¼ˆIndeed, SEEK, æœªæ¥å¯èƒ½æœ‰ LinkedIn/Glassdoorï¼‰ï¼Œæ¯ä¸ªæ•°æ®æºçš„ API æ ¼å¼å’Œå­—æ®µéƒ½ä¸åŒã€‚éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„æ–¹å¼æ¥ç®¡ç†è¿™äº›æ•°æ®æºã€‚

**éœ€æ±‚:**
1. ç»Ÿä¸€çš„æ•°æ®æ ¼å¼ï¼ˆJobPostingDTOï¼‰
2. æ˜“äºæ‰©å±•æ–°æ•°æ®æºï¼ˆä¸ä¿®æ”¹ç°æœ‰ä»£ç ï¼‰
3. æ¯ä¸ªæ•°æ®æºç‹¬ç«‹å®ç°ï¼ˆä¸äº’ç›¸å½±å“ï¼‰

### å†³ç­– (Decision)

**é€‰æ‹©é€‚é…å™¨æ¨¡å¼ (Adapter Pattern)**

**æ ¸å¿ƒè®¾è®¡:**
```python
# æŠ½è±¡åŸºç±»
class BaseJobAdapter(ABC):
    @abstractmethod
    def scrape(self, request: ScrapeRequest) -> List[JobPostingDTO]:
        """æ¯ä¸ªé€‚é…å™¨å¿…é¡»å®ç°æ­¤æ–¹æ³•"""
        pass

    @property
    @abstractmethod
    def platform_name(self) -> str:
        """å¹³å°åç§°"""
        pass

    def validate_request(self, request: ScrapeRequest):
        """é€šç”¨éªŒè¯é€»è¾‘"""
        if not request.keywords:
            raise ValueError("keywords is required")

# å…·ä½“é€‚é…å™¨
class SeekAdapter(BaseJobAdapter):
    @property
    def platform_name(self) -> str:
        return "seek"

    def scrape(self, request: ScrapeRequest) -> List[JobPostingDTO]:
        # 1. è°ƒç”¨ SEEK API
        data = self._call_seek_api(request)

        # 2. è½¬æ¢ä¸ºç»Ÿä¸€æ ¼å¼
        jobs = [self._transform_job(job_data) for job_data in data]

        return jobs

    def _transform_job(self, job_data: dict) -> JobPostingDTO:
        """SEEK ç‰¹å®šçš„æ•°æ®è½¬æ¢é€»è¾‘"""
        return JobPostingDTO(
            source=PlatformEnum.SEEK,
            source_id=job_data.get("id"),
            title=job_data.get("title"),
            # ... SEEK ç‰¹å®šå­—æ®µæ˜ å°„
        )
```

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: å•ä¸€å‡½æ•°ï¼ˆif-else åˆ†æ”¯ï¼‰
```python
def scrape_jobs(platform: str, keywords: str):
    if platform == "seek":
        # SEEK é€»è¾‘
        response = requests.get("https://seek.com.au/api/...")
        jobs = []
        for job in response.json()['data']:
            jobs.append({
                "title": job["title"],
                "company": job["advertiser"]["description"],
                # ...
            })
        return jobs

    elif platform == "indeed":
        # Indeed é€»è¾‘
        scraper = IndeedScraper()
        df = scraper.scrape(keywords)
        jobs = []
        for _, row in df.iterrows():
            jobs.append({
                "title": row["title"],
                "company": row["company"],
                # ...
            })
        return jobs

    # æœªæ¥æ·»åŠ  LinkedIn éœ€è¦ä¿®æ”¹è¿™ä¸ªå‡½æ•°
    elif platform == "linkedin":
        # ...
```

**ä¼˜ç‚¹:**
- å®ç°ç®€å•ï¼Œé€‚åˆåªæœ‰ 1-2 ä¸ªæ•°æ®æºçš„æƒ…å†µ

**ç¼ºç‚¹:**
- âŒ è¿åå¼€æ”¾å°é—­åŸåˆ™ï¼ˆæ¯æ¬¡æ·»åŠ æ–°æ•°æ®æºéœ€è¦ä¿®æ”¹å‡½æ•°ï¼‰
- âŒ ä»£ç éš¾ä»¥ç»´æŠ¤ï¼ˆæ‰€æœ‰é€»è¾‘æ··åœ¨ä¸€èµ·ï¼‰
- âŒ æµ‹è¯•å›°éš¾ï¼ˆæ— æ³•å•ç‹¬æµ‹è¯•æ¯ä¸ªæ•°æ®æºï¼‰
- âŒ æ‰©å±•æ€§å·®ï¼ˆæ·»åŠ  LinkedIn éœ€è¦æ”¹åŠ¨æ ¸å¿ƒå‡½æ•°ï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- ä¸é€‚åˆå¤šæ•°æ®æºåœºæ™¯
- æœªæ¥æ·»åŠ  3-5 ä¸ªæ•°æ®æºä¼šå¯¼è‡´ä»£ç æ··ä¹±

---

#### æ–¹æ¡ˆ B: å·¥å‚æ¨¡å¼ + ç­–ç•¥æ¨¡å¼
```python
# ç­–ç•¥æ¥å£
class ScrapingStrategy(ABC):
    @abstractmethod
    def scrape(self, keywords: str):
        pass

# å…·ä½“ç­–ç•¥
class SeekStrategy(ScrapingStrategy):
    def scrape(self, keywords: str):
        # SEEK é€»è¾‘
        pass

class IndeedStrategy(ScrapingStrategy):
    def scrape(self, keywords: str):
        # Indeed é€»è¾‘
        pass

# å·¥å‚
class ScraperFactory:
    @staticmethod
    def create_scraper(platform: str) -> ScrapingStrategy:
        if platform == "seek":
            return SeekStrategy()
        elif platform == "indeed":
            return IndeedStrategy()
        else:
            raise ValueError(f"Unknown platform: {platform}")

# ä½¿ç”¨
scraper = ScraperFactory.create_scraper("seek")
jobs = scraper.scrape("plumber")
```

**ä¼˜ç‚¹:**
- âœ… æ¯ä¸ªç­–ç•¥ç‹¬ç«‹
- âœ… ç¬¦åˆå¼€æ”¾å°é—­åŸåˆ™

**ç¼ºç‚¹:**
- âš ï¸ å·¥å‚ç±»ä»éœ€è¦ä¿®æ”¹ï¼ˆæ·»åŠ æ–°å¹³å°æ—¶ï¼‰
- âš ï¸ æ¯”é€‚é…å™¨æ¨¡å¼ç¨å¤æ‚ï¼ˆå¤šä¸€å±‚å·¥å‚ï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- é€‚é…å™¨æ¨¡å¼æ›´ç®€æ´ï¼ˆä¸éœ€è¦å·¥å‚ç±»ï¼‰
- å½“å‰ä¸éœ€è¦åŠ¨æ€åˆ‡æ¢ç­–ç•¥ï¼ˆFastAPI è·¯ç”±å·²ç»åŒºåˆ†å¹³å°ï¼‰

---

#### æ–¹æ¡ˆ C: é€‚é…å™¨æ¨¡å¼ï¼ˆæœ€ç»ˆé€‰æ‹©ï¼‰
```python
# æ¯ä¸ªé€‚é…å™¨ç‹¬ç«‹å®ç°
class SeekAdapter(BaseJobAdapter):
    def scrape(self, request: ScrapeRequest):
        # åªå…³æ³¨ SEEK é€»è¾‘
        pass

class IndeedAdapter(BaseJobAdapter):
    def scrape(self, request: ScrapeRequest):
        # åªå…³æ³¨ Indeed é€»è¾‘
        pass

# æ·»åŠ æ–°æ•°æ®æºä¸éœ€è¦ä¿®æ”¹ä»»ä½•ç°æœ‰ä»£ç 
class LinkedInAdapter(BaseJobAdapter):
    def scrape(self, request: ScrapeRequest):
        # LinkedIn é€»è¾‘
        pass

# FastAPI ç«¯ç‚¹
@app.post("/scrape/seek")
def scrape_seek(request: ScrapeRequest):
    adapter = SeekAdapter()  # ç›´æ¥ä½¿ç”¨
    return {"jobs": adapter.scrape(request)}

@app.post("/scrape/linkedin")
def scrape_linkedin(request: ScrapeRequest):
    adapter = LinkedInAdapter()  # æ–°å¢ç«¯ç‚¹ï¼Œä¸å½±å“ç°æœ‰ä»£ç 
    return {"jobs": adapter.scrape(request)}
```

**ä¼˜ç‚¹:**
- âœ… å®Œå…¨ç¬¦åˆå¼€æ”¾å°é—­åŸåˆ™ï¼ˆæ·»åŠ æ–°æ•°æ®æºä¸ä¿®æ”¹ç°æœ‰ä»£ç ï¼‰
- âœ… æ¯ä¸ªé€‚é…å™¨å®Œå…¨ç‹¬ç«‹ï¼ˆæµ‹è¯•å’Œç»´æŠ¤ç®€å•ï¼‰
- âœ… ä»£ç æ¸…æ™°ï¼ˆä¸€ä¸ªé€‚é…å™¨ä¸€ä¸ªæ–‡ä»¶ï¼‰
- âœ… æ˜“äºæ‰©å±•ï¼ˆæ–°å¢ LinkedInAdapter ä¸å½±å“ SeekAdapterï¼‰

**ç¼ºç‚¹:**
- éœ€è¦ä¸ºæ¯ä¸ªæ•°æ®æºåˆ›å»ºä¸€ä¸ªç±»ï¼ˆä½†è¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼‰

**ä¸ºä»€ä¹ˆé€‰æ‹©?**
- æœ€ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ï¼ˆå¤šæ•°æ®æºã€æ˜“æ‰©å±•ï¼‰
- ä»£ç ç»“æ„æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤
- å±•ç¤ºè®¾è®¡æ¨¡å¼ç†è§£ï¼ˆé¢è¯•åŠ åˆ†é¡¹ï¼‰

---

### å¯¹æ¯”æ€»ç»“

| æ–¹æ¡ˆ | å¯æ‰©å±•æ€§ | å¯ç»´æŠ¤æ€§ | ä»£ç å¤æ‚åº¦ | é€‚åˆåœºæ™¯ |
|------|----------|----------|------------|----------|
| if-else | â­ | â­ | â­â­â­â­â­ | 1-2 ä¸ªæ•°æ®æº |
| å·¥å‚+ç­–ç•¥ | â­â­â­â­ | â­â­â­â­ | â­â­â­ | éœ€è¦åŠ¨æ€åˆ‡æ¢ |
| é€‚é…å™¨ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | å¤šæ•°æ®æºã€é•¿æœŸç»´æŠ¤ |

### åæœ (Consequences)

**æ­£é¢å½±å“:**
- âœ… æˆåŠŸå®ç° Indeed å’Œ SEEK ä¸¤ä¸ªé€‚é…å™¨
- âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼ˆapp/adapters/ ç›®å½•ï¼‰
- âœ… æµ‹è¯•ç®€å•ï¼ˆæ¯ä¸ªé€‚é…å™¨ç‹¬ç«‹æµ‹è¯•ï¼‰
- âœ… æœªæ¥æ‰©å±• LinkedIn åªéœ€æ–°å¢ä¸€ä¸ªæ–‡ä»¶

**è´Ÿé¢å½±å“:**
- âš ï¸ éœ€è¦ç†è§£æŠ½è±¡åŸºç±»ï¼ˆä½†å­¦ä¹ æˆæœ¬ä½ï¼‰

**å®é™…æ•ˆæœ:**
- ä» Indeed åˆ° SEEK çš„å®ç°åªèŠ±äº† 2 å°æ—¶ï¼ˆæ¶æ„å·²æˆç†Ÿï¼‰
- æœªæ¥æ·»åŠ æ–°æ•°æ®æºé¢„è®¡åªéœ€ 2-3 å°æ—¶

**é¢è¯•æ—¶å¦‚ä½•è®²è¿°:**
> "æˆ‘ä½¿ç”¨äº†é€‚é…å™¨æ¨¡å¼æ¥ç®¡ç†å¤šä¸ªæ•°æ®æºã€‚æ¯ä¸ªæ•°æ®æºï¼ˆSEEKã€Indeedï¼‰éƒ½å®ç°äº†ç›¸åŒçš„æ¥å£ï¼ˆBaseJobAdapterï¼‰ï¼Œè¿”å›ç»Ÿä¸€çš„æ•°æ®æ ¼å¼ï¼ˆJobPostingDTOï¼‰ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šæ·»åŠ æ–°æ•°æ®æºæ—¶ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ç°æœ‰ä»£ç ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ–°çš„é€‚é…å™¨ç±»ã€‚è¿™ä½“ç°äº†å¼€æ”¾å°é—­åŸåˆ™ï¼ˆOpen-Closed Principleï¼‰ï¼Œä¹Ÿè®©ä»£ç æ›´å®¹æ˜“æµ‹è¯•å’Œç»´æŠ¤ã€‚"

---

## ADR-003: é€‰æ‹© TDD å¼€å‘å·¥å…·å‡½æ•°

**çŠ¶æ€:** âœ… å·²é‡‡çº³
**æ—¥æœŸ:** 2025-12-19
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P1ï¼ˆè´¨é‡ä¿è¯ï¼‰

### èƒŒæ™¯ (Context)

å·¥å…·å‡½æ•°ï¼ˆå¦‚ parse_location, extract_trade, parse_salary_rangeï¼‰æœ‰å¾ˆå¤šè¾¹ç¼˜æƒ…å†µéœ€è¦å¤„ç†ï¼Œä¾‹å¦‚:
- è–ªèµ„æ ¼å¼æœ‰åå‡ ç§å˜ä½“ï¼ˆ"$70,000 - $80,000", "$70k - $80k", "$35 per hour"ï¼‰
- åœ°ç‚¹æ ¼å¼å¤æ‚ï¼ˆ"Sydney NSW", "Melbourne VIC", "Remote"ï¼‰
- éœ€è¦ç¡®ä¿æ‰€æœ‰æƒ…å†µéƒ½æ­£ç¡®å¤„ç†

**é—®é¢˜:**
- å¦‚ä½•ç¡®ä¿å·¥å…·å‡½æ•°çš„æ­£ç¡®æ€§ï¼Ÿ
- å¦‚ä½•é¿å…é—æ¼è¾¹ç¼˜æƒ…å†µï¼Ÿ
- å¦‚ä½•åœ¨ä¸ç ´åç°æœ‰åŠŸèƒ½çš„å‰æä¸‹é‡æ„ä»£ç ï¼Ÿ

### å†³ç­– (Decision)

**é€‰æ‹© TDD (Test-Driven Development) æ–¹æ³•å¼€å‘å·¥å…·å‡½æ•°**

**å·¥ä½œæµç¨‹:**
1. **Red:** å…ˆå†™æµ‹è¯•ç”¨ä¾‹ï¼ˆåŒ…æ‹¬è¾¹ç¼˜æƒ…å†µï¼‰â†’ æµ‹è¯•å¤±è´¥
2. **Green:** ç¼–å†™æœ€å°‘çš„ä»£ç ä½¿æµ‹è¯•é€šè¿‡
3. **Refactor:** é‡æ„ä»£ç ï¼ˆä¼˜åŒ–é€»è¾‘ã€æå–é‡å¤ä»£ç ï¼‰

**ç¤ºä¾‹:**
```python
# 1. RED - å…ˆå†™æµ‹è¯•
def test_parse_salary_basic_range():
    assert parse_salary_range("$70,000 - $80,000") == (70000, 80000)
    # è¿è¡Œæµ‹è¯• â†’ å¤±è´¥ï¼ˆå‡½æ•°è¿˜æ²¡å®ç°ï¼‰

# 2. GREEN - å®ç°åŠŸèƒ½
def parse_salary_range(salary_str: str):
    # ç®€å•å®ç°ï¼Œåªå¤„ç†åŸºæœ¬æ ¼å¼
    parts = salary_str.replace("$", "").replace(",", "").split(" - ")
    return (int(parts[0]), int(parts[1]))
    # è¿è¡Œæµ‹è¯• â†’ é€šè¿‡

# 3. æ·»åŠ æ›´å¤šæµ‹è¯•ï¼ˆè¾¹ç¼˜æƒ…å†µï¼‰
def test_parse_salary_k_suffix():
    assert parse_salary_range("$70k - $80k") == (70000, 80000)
    # è¿è¡Œæµ‹è¯• â†’ å¤±è´¥ï¼ˆå½“å‰å®ç°ä¸æ”¯æŒ k åç¼€ï¼‰

# 4. GREEN - æ‰©å±•å®ç°
def parse_salary_range(salary_str: str):
    # å¤„ç† k åç¼€
    if 'k' in salary_str.lower():
        # ... æ‰©å±•é€»è¾‘
    # è¿è¡Œæµ‹è¯• â†’ é€šè¿‡

# 5. REFACTOR - é‡æ„
def parse_salary_range(salary_str: str):
    # æå–é‡å¤é€»è¾‘ï¼Œä¼˜åŒ–ä»£ç ç»“æ„
    # è¿è¡Œæµ‹è¯• â†’ ç¡®ä¿æ‰€æœ‰æµ‹è¯•ä»ç„¶é€šè¿‡
```

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: å…ˆå†™ä»£ç ï¼Œåè¡¥æµ‹è¯•
```python
# 1. ç›´æ¥å†™å®ç°
def parse_salary_range(salary_str: str):
    # ä¸€æ¬¡æ€§å®ç°æ‰€æœ‰é€»è¾‘ï¼ˆå¤„ç†æ‰€æœ‰æ ¼å¼ï¼‰
    # å¯èƒ½é—æ¼æŸäº›è¾¹ç¼˜æƒ…å†µ
    pass

# 2. æ‰‹åŠ¨æµ‹è¯•
print(parse_salary_range("$70,000 - $80,000"))  # è¾“å‡ºç»“æœï¼Œè‚‰çœ¼æ£€æŸ¥
print(parse_salary_range("$70k - $80k"))

# 3. åè¡¥å•å…ƒæµ‹è¯•ï¼ˆå¯èƒ½å¿˜è®°æŸäº›æƒ…å†µï¼‰
def test_parse_salary():
    assert parse_salary_range("$70,000 - $80,000") == (70000, 80000)
    # å…¶ä»–æµ‹è¯•...
```

**ä¼˜ç‚¹:**
- åˆæœŸå¼€å‘é€Ÿåº¦å¿«ï¼ˆä¸éœ€è¦å…ˆå†™æµ‹è¯•ï¼‰

**ç¼ºç‚¹:**
- âŒ å®¹æ˜“é—æ¼è¾¹ç¼˜æƒ…å†µï¼ˆæ²¡æœ‰ç³»ç»Ÿæ€§æ€è€ƒï¼‰
- âŒ é‡æ„å›°éš¾ï¼ˆæ²¡æœ‰æµ‹è¯•ä¿æŠ¤ï¼Œä¸æ•¢æ”¹ä»£ç ï¼‰
- âŒ è°ƒè¯•è€—æ—¶ï¼ˆéœ€è¦é‡å¤æ‰‹åŠ¨æµ‹è¯•ï¼‰
- âŒ åè¡¥æµ‹è¯•è´¨é‡ä½ï¼ˆå¯èƒ½åªæµ‹è¯•æ­£å¸¸æƒ…å†µï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- å·¥å…·å‡½æ•°è¾¹ç¼˜æƒ…å†µå¤šï¼Œå®¹æ˜“å‡ºé”™
- æ²¡æœ‰æµ‹è¯•ä¿æŠ¤ï¼Œé‡æ„æ—¶å¯èƒ½å¼•å…¥æ–° bug

---

#### æ–¹æ¡ˆ B: éƒ¨åˆ†æµ‹è¯•ï¼ˆåªæµ‹è¯•æ ¸å¿ƒé€»è¾‘ï¼‰
```python
# åªæµ‹è¯•æœ€å¸¸è§çš„æƒ…å†µ
def test_parse_salary():
    assert parse_salary_range("$70,000 - $80,000") == (70000, 80000)
    # ä¸æµ‹è¯• k åç¼€ã€æ—¶è–ªè½¬æ¢ç­‰è¾¹ç¼˜æƒ…å†µ

# å®ç°
def parse_salary_range(salary_str: str):
    # åªå®ç°åŸºæœ¬æ ¼å¼
    # é‡åˆ°å…¶ä»–æ ¼å¼æ—¶è¿”å› (None, None)
    pass
```

**ä¼˜ç‚¹:**
- å¿«é€Ÿå®ç°æ ¸å¿ƒåŠŸèƒ½

**ç¼ºç‚¹:**
- âŒ æ•°æ®è´¨é‡å·®ï¼ˆå¾ˆå¤šèŒä½çš„è–ªèµ„å­—æ®µä¸º Noneï¼‰
- âŒ æ— æ³•åˆ©ç”¨è–ªèµ„æ•°æ®ï¼ˆå¦‚è–ªèµ„èŒƒå›´ç­›é€‰ï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- è–ªèµ„æ˜¯é‡è¦å­—æ®µï¼Œåº”è¯¥å°½å¯èƒ½å‡†ç¡®
- è¾¹ç¼˜æƒ…å†µå®é™…ä¸Šå¾ˆå¸¸è§ï¼ˆSEEK æœ‰å¾ˆå¤š "$70k - $80k" æ ¼å¼ï¼‰

---

#### æ–¹æ¡ˆ C: TDDï¼ˆæœ€ç»ˆé€‰æ‹©ï¼‰
```python
# 1. ç³»ç»Ÿæ€§æ€è€ƒæ‰€æœ‰æƒ…å†µï¼ˆå†™æµ‹è¯•ç”¨ä¾‹ï¼‰
def test_parse_salary_range():
    # åŸºæœ¬èŒƒå›´
    assert parse_salary_range("$70,000 - $80,000") == (70000, 80000)
    # K åç¼€
    assert parse_salary_range("$70k - $80k") == (70000, 80000)
    # æ—¶è–ªè½¬å¹´è–ª
    assert parse_salary_range("$35 - $40 per hour") == (72800, 83200)
    # å•ä¸€å€¼
    assert parse_salary_range("$75,000") == (75000, 75000)
    # æ— æ•ˆè¾“å…¥
    assert parse_salary_range(None) == (None, None)
    # ... å…± 17 ä¸ªæµ‹è¯•ç”¨ä¾‹

# 2. æ¸è¿›å¼å®ç°ï¼ˆä¸€ä¸ªæµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ï¼‰
def parse_salary_range(salary_str: str):
    # é€æ­¥å®ç°ï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹
    # æœ€ç»ˆè¦†ç›–æ‰€æœ‰æƒ…å†µ
    pass

# 3. é‡æ„ï¼ˆä¼˜åŒ–ä»£ç ç»“æ„ï¼‰
def parse_salary_range(salary_str: str):
    # æå– _parse_k_suffix(), _parse_hourly_to_annual() ç­‰è¾…åŠ©å‡½æ•°
    # æµ‹è¯•ä¿æŠ¤ï¼Œç¡®ä¿é‡æ„ä¸ç ´ååŠŸèƒ½
    pass
```

**ä¼˜ç‚¹:**
- âœ… ç³»ç»Ÿæ€§æ€è€ƒè¾¹ç¼˜æƒ…å†µï¼ˆå†™æµ‹è¯•æ—¶å°±è€ƒè™‘äº†ï¼‰
- âœ… å¿«é€ŸéªŒè¯ï¼ˆpytest è‡ªåŠ¨è¿è¡Œ 69 ä¸ªæµ‹è¯•ï¼Œåªéœ€ 0.16 ç§’ï¼‰
- âœ… é‡æ„å®‰å…¨ï¼ˆæµ‹è¯•ä½œä¸ºå®‰å…¨ç½‘ï¼‰
- âœ… æ–‡æ¡£ä½œç”¨ï¼ˆæµ‹è¯•ç”¨ä¾‹å±•ç¤ºæ‰€æœ‰æ”¯æŒçš„æ ¼å¼ï¼‰

**ç¼ºç‚¹:**
- âš ï¸ åˆæœŸå¼€å‘ç¨æ…¢ï¼ˆéœ€è¦å…ˆå†™æµ‹è¯•ï¼‰
- âš ï¸ éœ€è¦å­¦ä¹  pytestï¼ˆä½†å­¦ä¹ æˆæœ¬ä½ï¼‰

**ä¸ºä»€ä¹ˆé€‰æ‹©?**
- å·¥å…·å‡½æ•°æ˜¯åŸºç¡€ç»„ä»¶ï¼Œè´¨é‡è¦æ±‚é«˜
- TDD ç¡®ä¿è¾¹ç¼˜æƒ…å†µä¸é—æ¼
- æµ‹è¯•ä½œä¸ºæ–‡æ¡£ï¼Œæ¸…æ™°å±•ç¤ºæ”¯æŒçš„æ ¼å¼

---

### å¯¹æ¯”æ€»ç»“

| æ–¹æ¡ˆ | å¼€å‘é€Ÿåº¦ | ä»£ç è´¨é‡ | é‡æ„å®‰å…¨ | è¾¹ç¼˜è¦†ç›– |
|------|----------|----------|----------|----------|
| å…ˆå†™ä»£ç  | â­â­â­â­â­ | â­â­ | â­ | â­â­ |
| éƒ¨åˆ†æµ‹è¯• | â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­ |
| TDD | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |

### åæœ (Consequences)

**æ­£é¢å½±å“:**
- âœ… 69 ä¸ªå•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ˆè¦†ç›–æ‰€æœ‰è¾¹ç¼˜æƒ…å†µï¼‰
- âœ… è–ªèµ„è§£æå‡†ç¡®ç‡é«˜ï¼ˆæ”¯æŒ 17 ç§æ ¼å¼ï¼‰
- âœ… é‡æ„è‡ªä¿¡ï¼ˆå¤šæ¬¡é‡æ„ä»£ç ï¼Œæµ‹è¯•å§‹ç»ˆé€šè¿‡ï¼‰
- âœ… é¢è¯•æ—¶å¯ä»¥å±•ç¤º TDD èƒ½åŠ›

**è´Ÿé¢å½±å“:**
- âš ï¸ åˆæœŸå¼€å‘ç¨æ…¢ï¼ˆä½†é•¿æœŸæ¥çœ‹èŠ‚çœäº†è°ƒè¯•æ—¶é—´ï¼‰

**å®é™…æ•ˆæœ:**
- parse_salary_range() å¼€å‘ç”¨æ—¶ 1.5 å°æ—¶ï¼ˆåŒ…æ‹¬ 17 ä¸ªæµ‹è¯•ï¼‰
- å¦‚æœä¸ç”¨ TDDï¼Œå¯èƒ½ 30 åˆ†é’Ÿå®ç°åŸºæœ¬åŠŸèƒ½ï¼Œä½†åç»­è°ƒè¯•è¾¹ç¼˜æƒ…å†µå¯èƒ½èŠ± 2-3 å°æ—¶
- **æ€»ç»“:** TDD å‰æœŸç¨æ…¢ï¼Œä½†æ•´ä½“æ•ˆç‡æ›´é«˜

**é¢è¯•æ—¶å¦‚ä½•è®²è¿°:**
> "åœ¨å¼€å‘å·¥å…·å‡½æ•°æ—¶ï¼Œæˆ‘é‡‡ç”¨äº† TDD æ–¹æ³•ã€‚ä¾‹å¦‚è–ªèµ„è§£æå‡½æ•°ï¼Œæˆ‘å…ˆåˆ—å‡ºäº†æ‰€æœ‰å¯èƒ½çš„æ ¼å¼ï¼ˆåŸºæœ¬èŒƒå›´ã€K åç¼€ã€æ—¶è–ªç­‰ï¼‰ï¼Œä¸ºæ¯ç§æ ¼å¼å†™äº†æµ‹è¯•ç”¨ä¾‹ï¼Œç„¶åæ¸è¿›å¼å®ç°åŠŸèƒ½ã€‚æœ€ç»ˆæˆ‘æœ‰ 17 ä¸ªæµ‹è¯•ç”¨ä¾‹è¦†ç›–æ‰€æœ‰è¾¹ç¼˜æƒ…å†µï¼Œè¿™ç¡®ä¿äº†æ•°æ®è´¨é‡ã€‚TDD çš„å¥½å¤„æ˜¯ï¼š1ï¼‰ç³»ç»Ÿæ€§æ€è€ƒè¾¹ç¼˜æƒ…å†µï¼Œä¸å®¹æ˜“é—æ¼ï¼›2ï¼‰é‡æ„æ—¶æœ‰æµ‹è¯•ä¿æŠ¤ï¼Œå¯ä»¥æ”¾å¿ƒä¼˜åŒ–ä»£ç ï¼›3ï¼‰æµ‹è¯•ç”¨ä¾‹æœ¬èº«å°±æ˜¯æ–‡æ¡£ï¼Œæ¸…æ™°å±•ç¤ºå‡½æ•°æ”¯æŒçš„æ‰€æœ‰æ ¼å¼ã€‚"

---

## ADR-004: ç¼“å­˜å±‚æ¶æ„è®¾è®¡

**çŠ¶æ€:** ğŸŸ¡ å¾…å®æ–½
**æ—¥æœŸ:** 2025-12-20
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P2ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰

### èƒŒæ™¯ (Context)

å½“å‰ç³»ç»Ÿæ¯æ¬¡æœç´¢éƒ½è°ƒç”¨å¤–éƒ¨ APIï¼ˆSEEK/Indeedï¼‰ï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜:
1. **æ€§èƒ½:** API å“åº”æ…¢ï¼ˆ1-3 ç§’ï¼‰ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ
2. **æˆæœ¬:** ç›¸åŒæœç´¢æ¡ä»¶é‡å¤è°ƒç”¨æµªè´¹èµ„æº
3. **é™æµé£é™©:** é¢‘ç¹è°ƒç”¨å¯èƒ½è¢« SEEK/Indeed é™æµ

**é—®é¢˜:** åœ¨å“ªä¸€å±‚å®ç°ç¼“å­˜ï¼Ÿ

### å†³ç­– (Decision)

**é€‰æ‹©åœ¨ Python FastAPI å±‚å®ç°ç¼“å­˜ï¼ˆæ¨èï¼‰**

**æ¶æ„å›¾:**
```
ç”¨æˆ·è¯·æ±‚
  â†“
.NET Backend (JobsController)
  â†“ HTTP è¯·æ±‚
Python FastAPI (/scrape/seek)
  â†“ æ£€æŸ¥ç¼“å­˜
  â”œâ”€ ç¼“å­˜å‘½ä¸­ â†’ è¿”å›ç¼“å­˜æ•°æ®ï¼ˆ50msï¼‰
  â””â”€ ç¼“å­˜æœªå‘½ä¸­ â†’ è°ƒç”¨ SEEK APIï¼ˆ1-3sï¼‰â†’ ç¼“å­˜ç»“æœ â†’ è¿”å›
```

**å®ç°æ–¹æ¡ˆï¼ˆé˜¶æ®µ 1 - ç®€å•ç¼“å­˜ï¼‰:**
```python
# app/services/cache_service.py
from datetime import datetime, timedelta
import hashlib

class SimpleCache:
    """å†…å­˜ç¼“å­˜ï¼Œé€‚åˆå•æœºéƒ¨ç½²"""

    def __init__(self, ttl_minutes=30):
        self._cache = {}  # {cache_key: (data, timestamp)}
        self._ttl = timedelta(minutes=ttl_minutes)

    def _generate_key(self, keywords: str, location: str = None) -> str:
        """ç”Ÿæˆç¼“å­˜ keyï¼ˆMD5 hashï¼‰"""
        raw_key = f"{keywords}:{location or ''}"
        return hashlib.md5(raw_key.encode()).hexdigest()

    def get(self, keywords: str, location: str = None):
        cache_key = self._generate_key(keywords, location)
        if cache_key in self._cache:
            data, timestamp = self._cache[cache_key]
            # æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
            if datetime.now() - timestamp < self._ttl:
                return data
            else:
                del self._cache[cache_key]  # æ¸…ç†è¿‡æœŸæ•°æ®
        return None

    def set(self, keywords: str, value, location: str = None):
        cache_key = self._generate_key(keywords, location)
        self._cache[cache_key] = (value, datetime.now())

# app/main.py
cache = SimpleCache(ttl_minutes=30)

@app.post("/scrape/seek")
def scrape_seek(request: ScrapeRequest):
    # 1. å°è¯•ä»ç¼“å­˜è·å–
    cached = cache.get(request.keywords, request.location)
    if cached:
        logger.info(f"ç¼“å­˜å‘½ä¸­: {request.keywords}")
        return {"jobs": cached, "from_cache": True}

    # 2. è°ƒç”¨ API
    adapter = SeekAdapter()
    jobs = adapter.scrape(request)

    # 3. ç¼“å­˜ç»“æœ
    cache.set(request.keywords, jobs, request.location)

    return {"jobs": jobs, "from_cache": False}
```

**é…ç½®:**
```python
# app/config.py
CACHE_ENABLED = True  # æ˜¯å¦å¯ç”¨ç¼“å­˜
CACHE_TTL_MINUTES = 30  # ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆ30 åˆ†é’Ÿï¼‰
```

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: .NET Backend å±‚ç¼“å­˜
```csharp
// Services/CacheService.cs
public class JobsCacheService
{
    private readonly IDistributedCache _cache;

    public async Task<List<JobDto>> GetOrFetchAsync(string keywords, string location)
    {
        var cacheKey = $"jobs:{keywords}:{location}";

        // 1. å°è¯•ä» Redis ç¼“å­˜è·å–
        var cachedData = await _cache.GetStringAsync(cacheKey);
        if (cachedData != null)
        {
            return JsonSerializer.Deserialize<List<JobDto>>(cachedData);
        }

        // 2. è°ƒç”¨ Python API
        var jobs = await _scrapeApiClient.ScrapeSeekAsync(keywords, location);

        // 3. ç¼“å­˜ç»“æœ
        await _cache.SetStringAsync(cacheKey, JsonSerializer.Serialize(jobs),
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(30)
            });

        return jobs;
    }
}

// Controllers/JobsController.cs
[HttpGet]
public async Task<IActionResult> SearchJobs([FromQuery] JobSearchRequest request)
{
    // ç›´æ¥ä½¿ç”¨ç¼“å­˜æœåŠ¡
    var jobs = await _cacheService.GetOrFetchAsync(request.Keywords, request.Location);
    return Ok(jobs);
}
```

**ä¼˜ç‚¹:**
- âœ… ç»Ÿä¸€ç®¡ç†ï¼ˆæ‰€æœ‰ç¼“å­˜é€»è¾‘åœ¨ä¸€ä¸ªåœ°æ–¹ï¼‰
- âœ… æ”¯æŒåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedisï¼‰
- âœ… å¯ä»¥ç¼“å­˜æ•°æ®åº“æŸ¥è¯¢ç»“æœï¼ˆä¸åªæ˜¯ API è°ƒç”¨ï¼‰

**ç¼ºç‚¹:**
- âŒ æ— æ³•å‡å°‘å¯¹ Python API çš„è°ƒç”¨ï¼ˆä»ç„¶ä¼šè°ƒç”¨ Pythonï¼Œåªæ˜¯ç¼“å­˜ .NET ç«¯çš„å“åº”ï¼‰
- âŒ å®ç°å¤æ‚ï¼ˆéœ€è¦é…ç½® Redisï¼‰
- âŒ å¼€å‘æˆæœ¬é«˜ï¼ˆéœ€è¦ä¿®æ”¹ .NET ä»£ç ï¼‰

**ä¸ºä»€ä¹ˆä¸æ¨è?**
- æ— æ³•å‡å°‘å¯¹å¤–éƒ¨ APIï¼ˆSEEK/Indeedï¼‰çš„è°ƒç”¨ï¼Œåªæ˜¯ç¼“å­˜äº† .NET ç«¯çš„å“åº”
- å®ç°æˆæœ¬é«˜ï¼Œæ”¶ç›Šæœ‰é™

---

#### æ–¹æ¡ˆ B: Python FastAPI å±‚ç¼“å­˜ï¼ˆæ¨èï¼‰
```python
# å¦‚ä¸Šé¢çš„å®ç°æ–¹æ¡ˆ
```

**ä¼˜ç‚¹:**
- âœ… å‡å°‘å¯¹å¤–éƒ¨ API çš„è°ƒç”¨ï¼ˆæ ¸å¿ƒç›®æ ‡ï¼‰
- âœ… å®ç°ç®€å•ï¼ˆä¸éœ€è¦ Redisï¼Œå†…å­˜ç¼“å­˜å³å¯ï¼‰
- âœ… å¼€å‘æˆæœ¬ä½ï¼ˆ1-2 å°æ—¶ï¼‰
- âœ… é˜²æ­¢è¢«é™æµï¼ˆSEEK/Indeed API é™æµï¼‰

**ç¼ºç‚¹:**
- âš ï¸ å•æœºç¼“å­˜ï¼ˆæ— æ³•è·¨å®ä¾‹å…±äº«ï¼‰
- âš ï¸ é‡å¯åç¼“å­˜ä¸¢å¤±

**ä¸ºä»€ä¹ˆæ¨è?**
- å½“å‰æ˜¯å•æœºéƒ¨ç½²ï¼Œä¸éœ€è¦åˆ†å¸ƒå¼ç¼“å­˜
- ç®€å•å®ç°å³å¯æ»¡è¶³éœ€æ±‚
- æœªæ¥å¯ä»¥å‡çº§ä¸º Redis ç¼“å­˜ï¼ˆæ¶æ„å·²é¢„ç•™ç©ºé—´ï¼‰

---

#### æ–¹æ¡ˆ C: åŒå±‚ç¼“å­˜ï¼ˆPython + .NETï¼‰
```python
# Python å±‚ç¼“å­˜ï¼ˆL1 - é˜²æ­¢ API è°ƒç”¨ï¼‰
@app.post("/scrape/seek")
def scrape_seek(request: ScrapeRequest):
    cached = python_cache.get(request.keywords)  # L1 ç¼“å­˜
    if cached:
        return cached

    jobs = seek_adapter.scrape(request)
    python_cache.set(request.keywords, jobs, ttl=1800)  # 30 åˆ†é’Ÿ
    return jobs
```

```csharp
// .NET å±‚ç¼“å­˜ï¼ˆL2 - é˜²æ­¢ HTTP è°ƒç”¨ï¼‰
public async Task<List<JobDto>> GetJobs(string keywords)
{
    var cacheKey = $"jobs:{keywords}";
    var cached = await _redis.GetAsync(cacheKey);  // L2 ç¼“å­˜
    if (cached != null)
    {
        return Deserialize(cached);
    }

    var jobs = await _pythonApi.ScrapeSeekAsync(keywords);
    await _redis.SetAsync(cacheKey, Serialize(jobs), ttl: 300);  // 5 åˆ†é’Ÿ
    return jobs;
}
```

**ä¼˜ç‚¹:**
- âœ… æœ€ä¼˜æ€§èƒ½ï¼ˆä¸¤å±‚ç¼“å­˜ï¼‰
- âœ… æœ€å¤§é™åº¦å‡å°‘å¤–éƒ¨è°ƒç”¨

**ç¼ºç‚¹:**
- âŒ å¤æ‚åº¦é«˜ï¼ˆéœ€è¦ç®¡ç†ä¸¤å±‚ç¼“å­˜ï¼‰
- âŒ ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼ˆä¸¤å±‚ TTL ä¸åŒï¼‰
- âŒ å¼€å‘æˆæœ¬é«˜

**ä¸ºä»€ä¹ˆä¸æ¨è?**
- è¿‡åº¦è®¾è®¡ï¼ˆå½“å‰æµé‡ä¸éœ€è¦åŒå±‚ç¼“å­˜ï¼‰
- å¢åŠ å¤æ‚åº¦ï¼Œæ”¶ç›Šæœ‰é™

---

### å¯¹æ¯”æ€»ç»“

| æ–¹æ¡ˆ | å‡å°‘ API è°ƒç”¨ | å®ç°æˆæœ¬ | é€‚ç”¨åœºæ™¯ |
|------|---------------|----------|----------|
| .NET å±‚ç¼“å­˜ | âŒ | â­â­ | ç¼“å­˜æ•°æ®åº“æŸ¥è¯¢ |
| Python å±‚ç¼“å­˜ | âœ… | â­â­â­â­â­ | å‡å°‘å¤–éƒ¨ API è°ƒç”¨ï¼ˆæ¨èï¼‰|
| åŒå±‚ç¼“å­˜ | âœ… | â­â­ | é«˜æµé‡åœºæ™¯ |

### å®æ–½è®¡åˆ’

**é˜¶æ®µ 1: ç®€å•å†…å­˜ç¼“å­˜ï¼ˆå½“å‰æ¨èï¼‰**
- æ—¶é—´: 1-2 å°æ—¶
- å®ç°: SimpleCache ç±»ï¼ˆå†…å­˜å­—å…¸ï¼‰
- TTL: 30 åˆ†é’Ÿ
- é€‚ç”¨: å•æœºéƒ¨ç½²

**é˜¶æ®µ 2: Redis ç¼“å­˜ï¼ˆæœªæ¥å‡çº§ï¼‰**
- æ—¶é—´: 2-3 å°æ—¶
- å®ç°: RedisCache ç±»
- TTL: 30 åˆ†é’Ÿ
- é€‚ç”¨: åˆ†å¸ƒå¼éƒ¨ç½²ã€é«˜æµé‡

**ä½•æ—¶å®æ–½é˜¶æ®µ 2?**
- æ¡ä»¶ 1: éƒ¨ç½²å¤šä¸ª Python å®ä¾‹ï¼ˆéœ€è¦å…±äº«ç¼“å­˜ï¼‰
- æ¡ä»¶ 2: ç¼“å­˜å‘½ä¸­ç‡é«˜ï¼ˆ> 50%ï¼‰ï¼Œå€¼å¾—æŠ•å…¥æ—¶é—´

### åæœ (Consequences)

**é¢„æœŸæ”¶ç›Š:**
- âœ… ç¼“å­˜å‘½ä¸­æ—¶å“åº”æ—¶é—´ < 50msï¼ˆvs API 1-3sï¼‰
- âœ… å‡å°‘ 50-80% çš„å¤–éƒ¨ API è°ƒç”¨ï¼ˆå‡è®¾æœ‰é‡å¤æœç´¢ï¼‰
- âœ… é™ä½è¢«é™æµé£é™©

**æƒè¡¡:**
- âš ï¸ ç¼“å­˜æ•°æ®å¯èƒ½è¿‡æ—¶ï¼ˆTTL 30 åˆ†é’Ÿå†…çš„æ•°æ®ï¼‰
- âš ï¸ å†…å­˜å ç”¨å¢åŠ ï¼ˆä½†å¯æ§ï¼Œæ¯ä¸ªç¼“å­˜é¡¹ < 100KBï¼‰

**ç›‘æ§æŒ‡æ ‡:**
- ç¼“å­˜å‘½ä¸­ç‡ï¼ˆhits / (hits + misses)ï¼‰
- å¹³å‡å“åº”æ—¶é—´ï¼ˆç¼“å­˜ vs APIï¼‰
- ç¼“å­˜å¤§å°ï¼ˆå†…å­˜å ç”¨ï¼‰

**é¢è¯•æ—¶å¦‚ä½•è®²è¿°:**
> "åœ¨è®¾è®¡ç¼“å­˜æ—¶ï¼Œæˆ‘è¯„ä¼°äº†ä¸¤ä¸ªæ–¹æ¡ˆï¼š.NET åç«¯å±‚ç¼“å­˜å’Œ Python çˆ¬è™«å±‚ç¼“å­˜ã€‚æœ€ç»ˆé€‰æ‹© Python å±‚ç¼“å­˜ï¼Œå› ä¸ºå®ƒèƒ½ç›´æ¥å‡å°‘å¯¹å¤–éƒ¨ APIï¼ˆSEEK/Indeedï¼‰çš„è°ƒç”¨ï¼Œè¿™æ˜¯æ ¸å¿ƒç›®æ ‡ã€‚è€Œ .NET å±‚ç¼“å­˜åªèƒ½å‡å°‘å¯¹ Python æœåŠ¡çš„ HTTP è°ƒç”¨ï¼Œæ— æ³•å‡å°‘å¤–éƒ¨ API è°ƒç”¨ã€‚æˆ‘å…ˆå®ç°äº†ç®€å•çš„å†…å­˜ç¼“å­˜ï¼ˆSimpleCacheï¼‰ï¼ŒTTL è®¾ç½®ä¸º 30 åˆ†é’Ÿï¼Œè¿™åœ¨å•æœºéƒ¨ç½²ä¸‹å·²ç»è¶³å¤Ÿã€‚å¦‚æœæœªæ¥éœ€è¦åˆ†å¸ƒå¼ç¼“å­˜ï¼Œæ¶æ„ä¸Šå·²ç»é¢„ç•™äº†å‡çº§ç©ºé—´ï¼Œå¯ä»¥è½»æ¾åˆ‡æ¢åˆ° Redisã€‚è¿™ä½“ç°äº†æˆ‘çš„å·¥ç¨‹åŒ–æ€ç»´ï¼š**åœ¨æ»¡è¶³å½“å‰éœ€æ±‚çš„å‰æä¸‹ï¼Œé€‰æ‹©æœ€ç®€å•çš„æ–¹æ¡ˆ**ã€‚"

---

## ADR-005: é€‰æ‹© PostgreSQL ä½œä¸ºä¸»æ•°æ®åº“

**çŠ¶æ€:** âœ… å·²é‡‡çº³
**æ—¥æœŸ:** 2025-12-14
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P0ï¼ˆæ ¸å¿ƒæ¶æ„ï¼‰

### èƒŒæ™¯ (Context)

éœ€è¦ä¸ºèŒä½èšåˆå¹³å°é€‰æ‹©ä¸€ä¸ªæ•°æ®åº“ï¼Œä¸»è¦éœ€æ±‚åŒ…æ‹¬:
1. å­˜å‚¨èŒä½æ•°æ®ï¼ˆtitle, company, location, salary ç­‰å­—æ®µï¼‰
2. æ”¯æŒå¤æ‚æŸ¥è¯¢ï¼ˆæŒ‰ tradeã€locationã€salary ç­›é€‰ï¼‰
3. æ”¯æŒå…¨æ–‡æœç´¢ï¼ˆæœªæ¥å¯èƒ½éœ€è¦ï¼‰
4. æœªæ¥å¯èƒ½éœ€è¦ AI è¯­ä¹‰æœç´¢ï¼ˆå‘é‡æœç´¢ï¼‰

### å†³ç­– (Decision)

**é€‰æ‹© PostgreSQL 16**

**æ ¸å¿ƒç†ç”±:**
1. **åŠŸèƒ½ä¸°å¯Œ:** æ”¯æŒ JSONã€å…¨æ–‡æœç´¢ã€GISï¼ˆåœ°ç†ä½ç½®ï¼‰
2. **æ‰©å±•æ€§:** æ”¯æŒ pgvectorï¼ˆå‘é‡æœç´¢ï¼Œä¸º AI æœç´¢é¢„ç•™ï¼‰
3. **æ€§èƒ½:** ç´¢å¼•ä¼˜åŒ–å¥½ï¼Œé€‚åˆå¤æ‚æŸ¥è¯¢
4. **ç”Ÿæ€æˆç†Ÿ:** EF Core æ”¯æŒå¥½ï¼Œç¤¾åŒºæ´»è·ƒ
5. **å…è´¹å¼€æº:** æ— è®¸å¯æˆæœ¬

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: MySQL
**ä¼˜ç‚¹:**
- ç®€å•æ˜“ç”¨ã€ç”Ÿæ€æˆç†Ÿ

**ç¼ºç‚¹:**
- âŒ JSON æ”¯æŒè¾ƒå¼±ï¼ˆè™½ç„¶æœ‰ JSON ç±»å‹ï¼Œä½†åŠŸèƒ½ä¸å¦‚ PostgreSQLï¼‰
- âŒ ä¸æ”¯æŒ pgvectorï¼ˆæ— æ³•åšå‘é‡æœç´¢ï¼‰
- âŒ å…¨æ–‡æœç´¢åŠŸèƒ½è¾ƒå¼±

**ä¸ºä»€ä¹ˆä¸é€‰?**
- æœªæ¥å¯èƒ½éœ€è¦ AI æœç´¢ï¼ˆpgvectorï¼‰
- PostgreSQL åŠŸèƒ½æ›´å¼ºå¤§ï¼Œå­¦ä¹ ä»·å€¼æ›´é«˜

---

#### æ–¹æ¡ˆ B: MongoDB
**ä¼˜ç‚¹:**
- çµæ´»çš„ Schemaï¼ˆæ–‡æ¡£å‹æ•°æ®åº“ï¼‰

**ç¼ºç‚¹:**
- âŒ .NET EF Core æ”¯æŒä¸å¦‚å…³ç³»å‹æ•°æ®åº“
- âŒ ä¸é€‚åˆå¤æ‚æŸ¥è¯¢ï¼ˆJOIN, èšåˆï¼‰
- âŒ å­¦ä¹ æ›²çº¿é™¡å³­ï¼ˆéœ€è¦å­¦ä¹  NoSQLï¼‰

**ä¸ºä»€ä¹ˆä¸é€‰?**
- èŒä½æ•°æ®æ˜¯ç»“æ„åŒ–çš„ï¼ˆé€‚åˆå…³ç³»å‹ï¼‰
- ä¸éœ€è¦ MongoDB çš„çµæ´»æ€§

---

#### æ–¹æ¡ˆ C: PostgreSQLï¼ˆæœ€ç»ˆé€‰æ‹©ï¼‰
**ä¼˜ç‚¹:**
- âœ… åŠŸèƒ½æœ€å…¨é¢ï¼ˆJSON + å…¨æ–‡æœç´¢ + å‘é‡æœç´¢ï¼‰
- âœ… EF Core æ”¯æŒå¥½
- âœ… å…è´¹å¼€æº

**ç¼ºç‚¹:**
- é…ç½®ç¨å¤æ‚ï¼ˆç›¸æ¯” SQLiteï¼‰

**ä¸ºä»€ä¹ˆé€‰æ‹©?**
- æ»¡è¶³æ‰€æœ‰å½“å‰å’Œæœªæ¥éœ€æ±‚
- å­¦ä¹ ä»·å€¼é«˜ï¼ˆä¼ä¸šçº§æ•°æ®åº“ï¼‰

### åæœ (Consequences)

**æ­£é¢å½±å“:**
- âœ… æ•°æ®åº“æ¶æ„ç¨³å®š
- âœ… ä¸º AI æœç´¢é¢„ç•™ç©ºé—´ï¼ˆpgvectorï¼‰

**è´Ÿé¢å½±å“:**
- âš ï¸ éœ€è¦å®‰è£…å’Œé…ç½® PostgreSQL

---

## ADR-006: é€‰æ‹© .NET 8 ä½œä¸ºåç«¯æ¡†æ¶

**çŠ¶æ€:** âœ… å·²é‡‡çº³
**æ—¥æœŸ:** 2025-12-14
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P0ï¼ˆæ ¸å¿ƒæ¶æ„ï¼‰

### èƒŒæ™¯ (Context)

éœ€è¦ä¸ºåç«¯ API é€‰æ‹©æŠ€æœ¯æ ˆï¼Œä¸»è¦éœ€æ±‚åŒ…æ‹¬:
1. RESTful APIï¼ˆèŒä½æŸ¥è¯¢ã€åˆ†æï¼‰
2. åå°ä»»åŠ¡ï¼ˆå®šæ—¶æŠ“å–ï¼‰
3. æ•°æ®åº“é›†æˆï¼ˆPostgreSQLï¼‰
4. é«˜æ€§èƒ½ï¼ˆå¤„ç†å¤§é‡æ•°æ®ï¼‰

### å†³ç­– (Decision)

**é€‰æ‹© .NET 8 + ASP.NET Core**

**æ ¸å¿ƒç†ç”±:**
1. **æ€§èƒ½ä¼˜ç§€:** .NET 8 æ˜¯é«˜æ€§èƒ½æ¡†æ¶
2. **ç”Ÿæ€æˆç†Ÿ:** EF Core, Hangfire ç­‰åº“å®Œå–„
3. **ç±»å‹å®‰å…¨:** C# å¼ºç±»å‹ï¼Œå‡å°‘é”™è¯¯
4. **è·¨å¹³å°:** å¯ä»¥éƒ¨ç½²åˆ° Linux
5. **å­¦ä¹ ä»·å€¼:** ä¼ä¸šçº§æŠ€æœ¯æ ˆ

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: Node.js + Express
**ä¼˜ç‚¹:**
- JavaScript å…¨æ ˆï¼ˆå‰åç«¯åŒè¯­è¨€ï¼‰

**ç¼ºç‚¹:**
- âŒ ç±»å‹å®‰å…¨è¾ƒå¼±ï¼ˆè™½ç„¶æœ‰ TypeScriptï¼‰
- âŒ æ€§èƒ½ä¸å¦‚ .NET

**ä¸ºä»€ä¹ˆä¸é€‰?**
- .NET æ€§èƒ½æ›´å¥½
- C# ç±»å‹å®‰å…¨æ›´å¥½

---

#### æ–¹æ¡ˆ B: Python + Django
**ä¼˜ç‚¹:**
- å…¨ Python æ ˆï¼ˆçˆ¬è™«å’Œåç«¯åŒè¯­è¨€ï¼‰

**ç¼ºç‚¹:**
- âŒ æ€§èƒ½ä¸å¦‚ .NET
- âŒ Django ORM ä¸å¦‚ EF Core

**ä¸ºä»€ä¹ˆä¸é€‰?**
- æ€§èƒ½è€ƒè™‘
- å­¦ä¹ å¤šç§æŠ€æœ¯æ ˆï¼ˆPython + .NETï¼‰

---

#### æ–¹æ¡ˆ C: .NET 8ï¼ˆæœ€ç»ˆé€‰æ‹©ï¼‰
**ä¼˜ç‚¹:**
- âœ… é«˜æ€§èƒ½
- âœ… ç±»å‹å®‰å…¨
- âœ… ç”Ÿæ€æˆç†Ÿ

**ç¼ºç‚¹:**
- å­¦ä¹ æ›²çº¿ç¨é™¡

**ä¸ºä»€ä¹ˆé€‰æ‹©?**
- æ»¡è¶³æ€§èƒ½è¦æ±‚
- ä¼ä¸šçº§æŠ€æœ¯æ ˆ

### åæœ (Consequences)

**æ­£é¢å½±å“:**
- âœ… API æ€§èƒ½ä¼˜ç§€
- âœ… ä»£ç è´¨é‡é«˜ï¼ˆå¼ºç±»å‹ï¼‰

**è´Ÿé¢å½±å“:**
- âš ï¸ éœ€è¦å­¦ä¹  C# å’Œ .NET

---

## ADR-007: é€‰æ‹© Hangfire ä½œä¸ºåå°ä»»åŠ¡æ¡†æ¶

**çŠ¶æ€:** âœ… å·²é‡‡çº³
**æ—¥æœŸ:** 2025-12-14
**å†³ç­–è€…:** å¼€å‘å›¢é˜Ÿ
**ä¼˜å…ˆçº§:** P0ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

### èƒŒæ™¯ (Context)

éœ€è¦å®ç°åå°ä»»åŠ¡ï¼ˆå®šæ—¶æŠ“å–èŒä½æ•°æ®ï¼‰ï¼Œä¸»è¦éœ€æ±‚åŒ…æ‹¬:
1. å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚æ¯å°æ—¶æŠ“å–ä¸€æ¬¡ï¼‰
2. é‡è¯•æœºåˆ¶ï¼ˆå¤±è´¥åè‡ªåŠ¨é‡è¯•ï¼‰
3. å¯è§†åŒ–ç›‘æ§ï¼ˆæŸ¥çœ‹ä»»åŠ¡çŠ¶æ€ï¼‰

### å†³ç­– (Decision)

**é€‰æ‹© Hangfire 1.8**

**æ ¸å¿ƒç†ç”±:**
1. **æ˜“ç”¨:** é…ç½®ç®€å•ï¼Œä»£ç å°‘
2. **å¯è§†åŒ–:** å†…ç½® Dashboardï¼Œå¯ä»¥æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€
3. **åŠŸèƒ½å®Œæ•´:** æ”¯æŒå®šæ—¶ä»»åŠ¡ã€é‡è¯•ã€ä¼˜å…ˆçº§
4. **å…è´¹:** åŸºç¡€åŠŸèƒ½å…è´¹

### æ›¿ä»£æ–¹æ¡ˆå’Œæƒè¡¡ (Trade-offs)

#### æ–¹æ¡ˆ A: Quartz.NET
**ä¼˜ç‚¹:**
- åŠŸèƒ½å¼ºå¤§

**ç¼ºç‚¹:**
- âŒ é…ç½®å¤æ‚
- âŒ æ²¡æœ‰å¯è§†åŒ– Dashboard

**ä¸ºä»€ä¹ˆä¸é€‰?**
- Hangfire æ›´æ˜“ç”¨

---

#### æ–¹æ¡ˆ B: Hangfireï¼ˆæœ€ç»ˆé€‰æ‹©ï¼‰
**ä¼˜ç‚¹:**
- âœ… æ˜“ç”¨
- âœ… å¯è§†åŒ–

**ç¼ºç‚¹:**
- é«˜çº§åŠŸèƒ½éœ€è¦ä»˜è´¹ï¼ˆä½†åŸºç¡€åŠŸèƒ½å¤Ÿç”¨ï¼‰

**ä¸ºä»€ä¹ˆé€‰æ‹©?**
- æ»¡è¶³éœ€æ±‚ï¼Œä¸”æ˜“ç”¨

### åæœ (Consequences)

**æ­£é¢å½±å“:**
- âœ… å¿«é€Ÿå®ç°åå°ä»»åŠ¡
- âœ… Dashboard ä¾¿äºç›‘æ§

**è´Ÿé¢å½±å“:**
- âš ï¸ é«˜çº§åŠŸèƒ½éœ€è¦ä»˜è´¹ï¼ˆä½†å½“å‰ä¸éœ€è¦ï¼‰

---

## ğŸ“– æ€»ç»“

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

æœ¬é¡¹ç›®çš„æ‰€æœ‰æ¶æ„å†³ç­–éµå¾ªä»¥ä¸‹åŸåˆ™:

1. **ç®€å•ä¼˜å…ˆ (Simplicity First)**
   - åœ¨æ»¡è¶³éœ€æ±‚çš„å‰æä¸‹ï¼Œé€‰æ‹©æœ€ç®€å•çš„æ–¹æ¡ˆ
   - ç¤ºä¾‹: SimpleCacheï¼ˆå†…å­˜ï¼‰vs Redisï¼ˆåˆ†å¸ƒå¼ï¼‰

2. **å¼€æ”¾å°é—­ (Open-Closed Principle)**
   - å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
   - ç¤ºä¾‹: BaseJobAdapter å…è®¸æ·»åŠ æ–°æ•°æ®æºè€Œä¸ä¿®æ”¹ç°æœ‰ä»£ç 

3. **æ¸è¿›å¼æ”¹è¿› (Incremental Improvement)**
   - å…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼ˆP0ï¼‰ï¼Œå†ä¼˜åŒ–ï¼ˆP1-P3ï¼‰
   - ç¤ºä¾‹: å…ˆç®€å•ç¼“å­˜ï¼Œæœªæ¥å‡çº§ä¸º Redis

4. **å­¦ä¹ ä»·å€¼ (Learning Value)**
   - é€‰æ‹©æœ‰å­¦ä¹ ä»·å€¼çš„æŠ€æœ¯ï¼ˆå¦‚ FastAPI, TDD, PostgreSQLï¼‰
   - å¹³è¡¡å®ç”¨æ€§å’ŒèŒä¸šå‘å±•

### é¢è¯•å‡†å¤‡å»ºè®®

**å¦‚ä½•è®²è¿°æ¶æ„å†³ç­–:**
1. **èƒŒæ™¯:** å½“æ—¶çš„éœ€æ±‚å’Œçº¦æŸæ˜¯ä»€ä¹ˆï¼Ÿ
2. **æ–¹æ¡ˆ:** è¯„ä¼°äº†å“ªäº›æ–¹æ¡ˆï¼Ÿ
3. **æƒè¡¡:** ä¸ºä»€ä¹ˆé€‰æ‹© A è€Œä¸æ˜¯ Bï¼Ÿ
4. **ç»“æœ:** å®é™…æ•ˆæœå¦‚ä½•ï¼Ÿæœ‰ä»€ä¹ˆæ”¶è·ï¼Ÿ

**ç¤ºä¾‹:**
> "åœ¨é€‰æ‹©çˆ¬è™«æ¡†æ¶æ—¶ï¼Œæˆ‘è¯„ä¼°äº† Flask å’Œ FastAPIã€‚è™½ç„¶ Flask æ›´ç®€å•ï¼Œä½† FastAPI çš„è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆå’Œæ•°æ®éªŒè¯åŠŸèƒ½å¯ä»¥æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡ã€‚è€ƒè™‘åˆ°é¡¹ç›®éœ€è¦é¢‘ç¹è°ƒè¯• API å’Œå¯¹æ¥ .NET åç«¯ï¼Œæˆ‘é€‰æ‹©äº† FastAPIã€‚å®é™…å¼€å‘ä¸­ï¼ŒSwagger UI ç¡®å®èŠ‚çœäº†å¾ˆå¤šæµ‹è¯•æ—¶é—´ï¼ŒéªŒè¯äº†æˆ‘çš„å†³ç­–ã€‚"

---

**æœ€åæ›´æ–°:** 2025-12-20
**ç»´æŠ¤è€…:** Claude Code
**å‚è€ƒ:** [OPTIMIZATION_PRIORITIES_GUIDE.md](../tutorials/OPTIMIZATION_PRIORITIES_GUIDE.md), [OPTIMIZATION_ROADMAP.md](./OPTIMIZATION_ROADMAP.md)
